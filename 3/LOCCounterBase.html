<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
<title>LOC Differences</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css">

body {
    background-color: #ffffff;
}

div.metrics table {
    margin-bottom: 2em;
}
div.metrics table td {
    white-space: nowrap;
}

div.metrics table td span.setHelp {
    padding-right: 21px;
    text-decoration: none;
}
div.metrics table td:hover span.setHelp {
    cursor: move;
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAANkE3LLaAgAAAaFJREFUeJyFkb9OG0EQh781B3JzioR0Ig0SFPAEiRQ3KIpsCVkUQMEDIAoQFFGq0FDQhIoOKUqRgi5FuhTs5QFMHiA0NAdGIHH8Mzmi4DMzKWyfOXyX/KrdmdlvfzNjyNHG+3faPW9ubZu8Ogdgbf5Fufpy/Hs3uN8YZXZhBYDb6BxAXz2rJ4+Wt/zh40bjGsAAfP6wqdMlD4CPe4fMLqxwG51zGZ4BcBQE3ISnLE9PALBXC1lc3zCJAwDnd/uHtaki9YNPuIDbyY2NACMD3JwcdCJeuoXHCq/uuPCqeS0zGn7rn8FjnXhV3ryewhkqpuK+71MqlajVgPqPbMDF1S/wwJjsobuu24a0r4NAXOgm72PJtZ0FsdY2Uw7iuJUUiQgFBdUetFKp4Pt+HzA9g451hfaCtZdSVcrlMsYYjDEJLBugioqiqjyViOA4vWdPttABiCAiqRa6sH8D5CEpilst0PRgVbVvQw7Al6+7b39OPq82Y7mbWZqZu2/GUhwYKoj0b0Y1u7VE1lqNouiP/kfWWs2YAQRBsArs5H+ROFkH+Att99BK1T3CFwAAAABJRU5ErkJggg==");
    background-position: center right;
    background-repeat: no-repeat;
}

pre {
    margin-top: 0px;
    margin-bottom: 0px;
}
table.locDiff td {
    white-space: pre;
    font-family: monospace;
    font-size: 10pt;
}
span.comment {
    color: #32cd32;
}

td.locDelHdr {
    background-color: #ff0000;
}
td.locDelBody {
    text-decoration: line-through;
    color: #ff0000;
}
td.locDelBody span.comment {
    color: #ff00ff;
}

td.locAddHdr {
    background-color: #0000ff;
}

td.locAddBody {
    color: #0000ff;
    font-weight: bold;
}
td.locAddBody span.comment {
    color: #32cdcc;
}
</style>

<!-- IE 7 and below do not support "data:" URLs, so we offer an alternative -->
<!--[if lte IE 7]><style type="text/css">
    div.metrics table td:hover span.setHelp {
        background-image: url("http://www.processdash.com/diffSetHelpIcon");
    }
</style><![endif]-->
</head><body>
<h1>LOC Differences</h1>
<div class="metrics"><table border=""><tbody><tr><th>Unchanged Files:</th><th>Base</th><th>Type</th></tr>
<tr><td><a href="#diffFile:B161:D0:M0:A0:T161:C_3a_5cUsers_5cdelan_5cDocuments_5cGitHub_5cpsphw_5c2_5chomework.c">C:\Users\delan\Documents\GitHub\psphw\2\homework.c<span title="Drag and drop this link onto a row of the Size Estimating Template to apply actual LOC counts" class="setHelp">&nbsp;</span></a></td><td>161</td><td>C</td></tr>
</tbody></table>
<table border="">
<tbody><tr><td>Total:&nbsp;</td><td>161</td></tr>
</tbody></table></div><hr>
<div id="diffFile:B161:D0:M0:A0:T161:C_3a_5cUsers_5cdelan_5cDocuments_5cGitHub_5cpsphw_5c2_5chomework.c" title="C:\Users\delan\Documents\GitHub\psphw\2\homework.c"><h2>C:\Users\delan\Documents\GitHub\psphw\2\homework.c</h2>
<table class="locDiff" border="0" cellpadding="0" cellspacing="0">
<tbody><tr><td>&nbsp;</td><td><pre><span class="comment">/**</span>
<span class="comment"> * @file homework.c</span>
<span class="comment"> * @brief PSP0.1 homework by Delan Azabani (#17065012)</span>
<span class="comment"> */</span>

#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;math.h&gt;

typedef struct psp_node {
        double x;
        double y;
        struct psp_node *next;
} *psp_node;

typedef struct psp_list {
        psp_node head;
} *psp_list;

<span class="comment">/**</span>
<span class="comment"> * @brief Allocates and returns a new, empty linked list from the heap.</span>
<span class="comment"> */</span>

psp_list        psp_list_new(void);

<span class="comment">/**</span>
<span class="comment"> * @brief Frees all nodes in the given list, then the list itself.</span>
<span class="comment"> */</span>

void            psp_list_free(psp_list list);

<span class="comment">/**</span>
<span class="comment"> * @brief Allocates and returns a new list node with the given data.</span>
<span class="comment"> */</span>

psp_node        psp_node_new(double x, double y);

<span class="comment">/**</span>
<span class="comment"> * @brief Frees the given node.</span>
<span class="comment"> */</span>

void            psp_node_free(psp_node node);

<span class="comment">/**</span>
<span class="comment"> * @brief Prepends the given node onto the beginning of the given list.</span>
<span class="comment"> */</span>

void            psp_insert(psp_list list, psp_node node);

<span class="comment">/**</span>
<span class="comment"> * @brief Reads input data from the given file into the given list.</span>
<span class="comment"> * The text file must assume the following format:</span>
<span class="comment"> * $x_k$</span>
<span class="comment"> * $x_0$ $y_0$</span>
<span class="comment"> * $x_i$ $y_i$</span>
<span class="comment"> * @return the value $x_k$ to be estimated.</span>
<span class="comment"> */</span>

double          psp_read(psp_list list, FILE *file);

<span class="comment">/**</span>
<span class="comment"> * @brief Calculates and returns the mean of all x values in the given list.</span>
<span class="comment"> */</span>

double          psp_mean_x(psp_list list);

<span class="comment">/**</span>
<span class="comment"> * @brief Calculates and returns the mean of all y values in the given list.</span>
<span class="comment"> */</span>

double          psp_mean_y(psp_list list);

<span class="comment">/**</span>
<span class="comment"> * @brief Calculates and returns $r_{x,y}$, the correlation coefficient.</span>
<span class="comment"> */</span>

double          psp_correlation(psp_list list);

<span class="comment">/**</span>
<span class="comment"> * @brief Calculates and returns the intercept of the linear regression line.</span>
<span class="comment"> */</span>

double          psp_reg_intercept(psp_list list);

<span class="comment">/**</span>
<span class="comment"> * @brief Calculates and returns the gradient of the linear regression line.</span>
<span class="comment"> */</span>

double          psp_reg_gradient(psp_list list);

<span class="comment">/**</span>
<span class="comment"> * @brief Calculates and returns an estimate for y based on a regression line.</span>
<span class="comment"> */</span>

double          psp_reg_estimate(psp_list list, double x);

<span class="comment">/**</span>
<span class="comment"> * @brief Runs tests on the homework code.</span>
<span class="comment"> */</span>

int             main(void);

psp_list        psp_list_new(void) {
        psp_list list = malloc(sizeof(struct psp_list));
        list-&gt;head = NULL;
        return list;
}

void            psp_list_free(psp_list list) {
        psp_node node = list-&gt;head;
        psp_node next;
        while (node) {
                next = node-&gt;next;
                psp_node_free(node);
                node = next;
        }
        free(list);
}

psp_node        psp_node_new(double x, double y) {
        psp_node node = malloc(sizeof(struct psp_node));
        node-&gt;x = x;
        node-&gt;y = y;
        node-&gt;next = NULL;
        return node;
}

void            psp_node_free(psp_node node) {
        free(node);
}

void            psp_insert(psp_list list, psp_node node) {
        if (list-&gt;head)
                node-&gt;next = list-&gt;head;
        list-&gt;head = node;
}

double          psp_read(psp_list list, FILE *file) {
        double output, x, y;
        fscanf(file, "%lf", &amp;output);
        while (fscanf(file, "%lf %lf", &amp;x, &amp;y) == 2)
                psp_insert(list, psp_node_new(x, y));
        return output;
}

double          psp_mean_x(psp_list list) {
        size_t count = 0;
        double sum = 0.0;
        psp_node node = list-&gt;head;
        while (node) {
                count++;
                sum += node-&gt;x;
                node = node-&gt;next;
        }
        return sum / count;
}

double          psp_mean_y(psp_list list) {
        size_t count = 0;
        double sum = 0.0;
        psp_node node = list-&gt;head;
        while (node) {
                count++;
                sum += node-&gt;y;
                node = node-&gt;next;
        }
        return sum / count;
}

double          psp_correlation(psp_list list) {
        size_t n = 0;
        double sum_x = 0.0;
        double sum_y = 0.0;
        double sum_x_y = 0.0;
        double sum_x_squared = 0.0;
        double sum_y_squared = 0.0;
        double left;
        double right;
        double num;
        double den;
        psp_node node = list-&gt;head;
        while (node) {
                double x = node-&gt;x;
                double y = node-&gt;y;
                n++;
                sum_x += x;
                sum_y += y;
                sum_x_y += x * y;
                sum_x_squared += x * x;
                sum_y_squared += y * y;
                node = node-&gt;next;
        }
        left = n * sum_x_squared - sum_x * sum_x;
        right = n * sum_y_squared - sum_y * sum_y;
        num = n * sum_x_y - sum_x * sum_y;
        den = sqrt(left * right);
        return num / den;
}

double          psp_reg_intercept(psp_list list) {
        double x_avg = psp_mean_x(list);
        double y_avg = psp_mean_y(list);
        return y_avg - x_avg * psp_reg_gradient(list);
}

double          psp_reg_gradient(psp_list list) {
        size_t n = 0;
        double sum_x_y = 0.0;
        double sum_x_squared = 0.0;
        double x_avg = psp_mean_x(list);
        double y_avg = psp_mean_y(list);
        double num;
        double den;
        psp_node node = list-&gt;head;
        while (node) {
                double x = node-&gt;x;
                double y = node-&gt;y;
                n++;
                sum_x_y += x * y;
                sum_x_squared += x * x;
                node = node-&gt;next;
        }
        num = sum_x_y - n * x_avg * y_avg;
        den = sum_x_squared - n * x_avg * x_avg;
        return num / den;
}

double          psp_reg_estimate(psp_list list, double x) {
        double intercept = psp_reg_intercept(list);
        double gradient = psp_reg_gradient(list);
        return intercept + gradient * x;
}

int             main(void) {
        int i = 0;
        char filename[256];
        FILE *file;
        psp_list list;
        do {
                i++;
                sprintf(filename, "test%04d.txt", i);
                file = fopen(filename, "r");
                if (file) {
                        double estimate;
                        list = psp_list_new();
                        estimate = psp_read(list, file);
                        printf("[%04d] to estimate x:             %f\n",
                                i, estimate);
                        printf("[%04d] mean x:                    %f\n",
                                i, psp_mean_x(list));
                        printf("[%04d] mean y:                    %f\n",
                                i, psp_mean_y(list));
                        printf("[%04d] intercept Î²â‚€:              %f\n",
                                i, psp_reg_intercept(list));
                        printf("[%04d] gradient Î²â‚�:               %f\n",
                                i, psp_reg_gradient(list));
                        printf("[%04d] correlation r:             %f\n",
                                i, psp_correlation(list));
                        printf("[%04d] correlation rÂ²:            %f\n",
                                i, psp_correlation(list) *
                                psp_correlation(list));
                        printf("[%04d] estimate y:                %f\n",
                                i, psp_reg_estimate(list, estimate));
                        putchar('\n');
                        psp_list_free(list);
                        fclose(file);
                }
        } while (file);
        return 0;
}</pre></td></tr>
</tbody></table></div>
</body></html>